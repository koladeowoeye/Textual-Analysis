{% load staticfiles %}
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Posit API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="{% static 'print.css' %}" rel="stylesheet" media="print" />
    <link href="{% static 'screen.css' %}" rel="stylesheet" media="screen" />
    <script src="{% static 'all.js' %}" ></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;ruby&quot;,&quot;python&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="{% static 'navbar.png' %}" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
        <img src="{% static 'logo.png' %}" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="python">python</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#usage" class="toc-h1 toc-link" data-title="usage">Usage</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#run-posit" class="toc-h2 toc-link" data-title="run-posit">Run posit</a>
                  </li>
                  <li>
                    <a href="#download-posit-result" class="toc-h2 toc-link" data-title="download-posit-result">Download Posit Result</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="errors">Errors</a>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com'>Posit Project 2018</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p> The Posit API is an extension of the actual Posit system that was built on django, python and AWS elaticbeanstack. 
The Posit API has two end-points.
1. /api_posit
2. /result/{result_name}, where result_name is a unique id auto generated for  a particular posit call
<br>
</p>
<p>
The /api_posit endpoint receives a http POST request from any services with a zipped input file of key "file_input".  The request call triggers an inner function that performs the posit analysis and returns a zipped output of the result.
<br>
</p>
<p>
The /result/<result_name> end-point receive a GET request to download the result of a particular /api_posit call.  When it receive a request call, it triggers an internal function that search the AWS Linux file system for the result of the <result_name> passed in. Once it find it, it returns the  zipped  file back to the  request  call. 
</p>
<p>There is an scheduled cron_job (a linux) process to remove result after 2 days so as to minimise storage space, this action will help save a lot of space in the
file system. </p>

<p>The API has some language binding in Shell, Ruby, Python and Java. Each programming language can be switched from one programing language to another. The source code for each language is displayed on the right hand side kf the page.

</p>

<h1 id='usage'>Usage</h1><h2 id='run-posit'>Run posit</h2><pre class="highlight ruby tab-ruby"><code>
<span class="c1">#using  RestClient.</span>
<span class="c1">#gem install rest-client will get you started</span>

<span class="nb">require</span> <span class="s1">'rest_client'</span>
<span class="no">RestClient</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="s1">'django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com'</span><span class="p">,</span> <span class="ss">:input_file</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'/path/to/file.zip'</span><span class="p">))</span>

</code></pre><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s">'input_file'</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="s">'input.zip'</span><span class="p">,</span><span class="s">'rb'</span><span class="p">)}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">"http://django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com/api_posit"</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

</code></pre><pre class="highlight shell tab-shell"><code>curl -i -X POST -H <span class="s2">"Content-type: multipart/form-data"</span> 
  -F <span class="s2">"input_file=@/path/to/file/input.zip"</span> 
  http://django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com/api_posit
</code></pre><pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>
<span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"input_file"</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"input_file"</span><span class="p">).</span><span class="nx">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"POST"</span><span class="p">,</span> <span class="s2">"http://django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com/api_posit"</span><span class="p">);</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">formData</span><span class="p">);</span>

</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="s2">"result_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20180414122535-f87a"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"input"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"webapge1.txt"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"webapge2.txt"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"webapge3.txt"</span><span class="p">,</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"Total_input"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"result_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com/result/20180414122535-f87a"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ip_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"41.3XX.X.X"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"date_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-04-14 12-26-02"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves all kittens.</p>
<h3 id='base-url'>Base URL</h3>
<p><code>URL django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com</code></p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /api_posit</code></p>

<p><code>Body: Form-Data encoded</code></p>
<h3 id='request-parameters'>Request Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>input_file</td>
<td>zipped input file containing all input text samples to run the posit on</td>
</tr>
</tbody></table>
<h3 id='http-response'>HTTP Response</h3>
<p><code>Header : Content-Type →application/json</code></p>
<h3 id='response-parameters'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>result_name</td>
<td>a unique request name auto generated from the server</td>
</tr>
<tr>
<td>input</td>
<td>returns a json object with two attribute &quot;files&quot; (listing all the input files) and &quot;total_input&quot; (the total number of input files)</td>
</tr>
<tr>
<td>input_file</td>
<td>zipped file containing all input text source to be processed</td>
</tr>
<tr>
<td>result_url</td>
<td>link or url to retrieve or download the result of the posit process</td>
</tr>
<tr>
<td>ip_address</td>
<td>ip address of client that makes the request</td>
</tr>
<tr>
<td>data_time</td>
<td>data and time which the request was made</td>
</tr>
<tr>
<td>error</td>
<td>optional, return this parameter with if there is any form of error, its a json object containing &quot;message&quot; ( reason for the erro) and &quot;code&quot; (error code to be interpeted with the error documentation</td>
</tr>
</tbody></table>
<h2 id='download-posit-result'>Download Posit Result</h2><pre class="highlight ruby tab-ruby"><code>
<span class="c1">#using  RestClient.</span>
<span class="c1">#gem install rest-client will get you started</span>

<span class="nb">require</span> <span class="s1">'rest_client'</span>
<span class="no">RestClient</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s1">'django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com/result/&lt;result_name&gt;'</span><span class="p">)</span>

</code></pre><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span><span class="p">,</span> <span class="n">zipfile</span><span class="p">,</span> <span class="n">StringIO</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com/result/&lt;result_name&gt;"</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="c"># check status code</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="c"># check result header</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">StringIO</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
<span class="n">z</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span> <span class="c"># extract all files</span>

<span class="c">#For python 3+, sub the StringIO module with the io module and use BytesIO instead of StringIO:  </span>
<span class="kn">import</span> <span class="nn">requests</span><span class="p">,</span> <span class="n">zipfile</span><span class="p">,</span> <span class="n">io</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com/result/&lt;result_name&gt;"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="c"># check status code</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="c"># check result header</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
<span class="n">z</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span> <span class="c">#extract all files</span>

</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com/result/&lt;result_name&gt;"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">xmlHttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span> <span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"http://django-env.qqhswtcpb3.us-west-2.elasticbeanstalk.com/result/&lt;result_name&gt;"</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span> <span class="c1">// false for synchronous request</span>
    <span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span> <span class="kc">null</span> <span class="p">);</span>
    <span class="k">return</span> <span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<p>Get the result of the posit algorithm request, result will be returned in .zip format</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET /result/20180414122535-f87a/&lt;result_name&gt;</code></p>
<h3 id='http-response-2'>HTTP Response</h3>
<p><code>Header : Content-Type →(&#39;application/zip&#39;, none)</code></p>
<h1 id='errors'>Errors</h1>
<p>The POSIT API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified &quot;result_name&quot; could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access  posit api with an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a with invalid input/file format.</td>
</tr>
<tr>
<td>410</td>
<td>Gone -- The result data  has been removed from our servers.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- Too many posit api request! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="python">python</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
